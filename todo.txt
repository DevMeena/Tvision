refactor code
add useful comments